{{define "content"}}
<div class="cti-knowledge-plane-box">       
   <div class="cti-knowledge-plane-box-header">
        <div class="plane-box-search">
            <div class="ui fluid action input">
                <input type="text" placeholder="IP、URL、HASH、CVE、 国家">
                <div class="ui primary button">查询</div>
            </div>
        </div>
   </div>
   <div class="cti-knowledge-plane-box-body">
        <div class="plane-box-body-nav">
            <a class="nav-item" href="/knowledge-plane?tab=normal">
                常规攻击(1209)
            </a>
            <a class="nav-item" href="/knowledge-plane?tab=traffic">
                流量攻击(123)
            </a>
            <a class="nav-item" href="/knowledge-plane?tab=feature">
                攻击特征(556)
            </a>
        </div>
        <div class="plane-box-body-box-1">
            <div class="body-box-1-top">
                <div class="top-left-box">
                    <div class="box-head">
                        IOC分布地图
                        <div class="box-head-toolbar head-toolbar-1">
                            <a class="ui small blue  label" data-tab="world">世界</a>
                            <a class="ui small label" data-tab="china">中国</a>
                        </div>
                    </div>
                    <div class="box-body">
                        <div id="ctiWorldMap"></div>
                    </div>
                </div>
                <div class="top-right-box">
                    <div class="box-head">
                        IOC类型分布
                        <div class="box-head-toolbar head-toolbar-2">
                            <a class="ui small blue  label" data-tab="ioc_type">IOC类型</a>
                            <a class="ui small label" data-tab="attack_type">攻击类型</a>
                        </div>
                    </div>
                    <div class="box-body">
                        <div id="typePieChart"></div>
                    </div>
                </div>
            </div>
            <div class="body-box-1-buttom">
                <div class="box-head">
                    攻击类型统计
                    <div class="box-head-toolbar head-toolbar-3">
                        <a class="ui small blue label" data-tab="hour">小时</a>
                        <a class="ui small label" data-tab="day">天</a>
                        <a class="ui small label" data-tab="month">月</a>
                       
                        
                    </div>
                </div>
                <div class="box-body">
                    <div id="ctiTimelineChart"></div>
                </div>
            </div>
        </div>
        <div class="plane-box-body-box-2">
            <div class="box-head">
                攻击IOC信息
                <!-- <div class="box-head-toolbar head-toolbar-3">
                    <a class="ui small blue label" data-tab="hour">小时</a>
                    <a class="ui small label" data-tab="day">天</a>
                    <a class="ui small label" data-tab="month">月</a>             
                </div> -->
            </div>
            <div class="box-body ioc-info-table-box">
                <table class="ioc-info-table">
                    <colgroup>
                        <col style="width: 100px;">
                        <col style="width: 100px;">
                        <col style="width: 60px;">
                        <col style="width: 60px;">
                        <col style="width: 100px;">
                        <col style="width: 100px;">
                        <col style="width: 60px;">
                    </colgroup>
                    <thead>
                        <tr>
                            <th>IP地址</th>
                            <th>物理地址</th>
                            <th>攻击类型</th>
                            <th>端口</th>
                            <th>HASH</th>
                            <th>观测时间</th>
                            <th>操作</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>12.127.8.1</td>
                            <td>越南</td>
                            <td>DDoS</td>
                            <td>7070</td>
                            <td>adbdbca54ab</td>
                            <td>2024-11-15 10:25:06</td>
                            <td>
                                <a class="open-cti-detail" data-id="1">详情</a>
                            </td>
                        </tr>
                        <tr>
                            <td>12.127.8.1</td>
                            <td>越南</td>
                            <td>DDoS</td>
                            <td>7070</td>
                            <td>adbdbca54ab</td>
                            <td>2024-11-15 10:25:06</td>
                            <td>
                                <a class="open-cti-detail" data-id="1">详情</a>
                            </td>
                        </tr>
                        <tr>
                            <td>12.127.8.1</td>
                            <td>越南</td>
                            <td>DDoS</td>
                            <td>7070</td>
                            <td>adbdbca54ab</td>
                            <td>2024-11-15 10:25:06</td>
                            <td>
                                <a class="open-cti-detail" data-id="1">详情</a>
                            </td>
                        </tr>
                        <tr>
                            <td>12.127.8.1</td>
                            <td>越南</td>
                            <td>DDoS</td>
                            <td>7070</td>
                            <td>adbdbca54ab</td>
                            <td>2024-11-15 10:25:06</td>
                            <td>
                                <a class="open-cti-detail" data-id="1">详情</a>
                            </td>
                        </tr>
                        <tr>
                            <td>12.127.8.1</td>
                            <td>越南</td>
                            <td>DDoS</td>
                            <td>7070</td>
                            <td>adbdbca54ab</td>
                            <td>2024-11-15 10:25:06</td>
                            <td>
                                <a class="open-cti-detail" data-id="1">详情</a>
                            </td>
                        </tr>
                        <tr>
                            <td>12.127.8.1</td>
                            <td>越南</td>
                            <td>DDoS</td>
                            <td>7070</td>
                            <td>adbdbca54ab</td>
                            <td>2024-11-15 10:25:06</td>
                            <td>
                                <a class="open-cti-detail" data-id="1">详情</a>
                            </td>
                        </tr>
                        <tr>
                            <td>12.127.8.1</td>
                            <td>越南</td>
                            <td>DDoS</td>
                            <td>7070</td>
                            <td>adbdbca54ab</td>
                            <td>2024-11-15 10:25:06</td>
                            <td>
                                <a class="open-cti-detail" data-id="1">详情</a>
                            </td>
                        </tr>
                        <tr>
                            <td>12.127.8.1</td>
                            <td>越南</td>
                            <td>DDoS</td>
                            <td>7070</td>
                            <td>adbdbca54ab</td>
                            <td>2024-11-15 10:25:06</td>
                            <td>
                                <a class="open-cti-detail" data-id="1">详情</a>
                            </td>
                        </tr>
                        <tr>
                            <td>12.127.8.1</td>
                            <td>越南</td>
                            <td>DDoS</td>
                            <td>7070</td>
                            <td>adbdbca54ab</td>
                            <td>2024-11-15 10:25:06</td>
                            <td>
                                <a class="open-cti-detail" data-id="1">详情</a>
                            </td>
                        </tr>
                    </tbody>
                </table>
                <div class="ui right floated pagination menu cti-data-table-nav tiny">
                    <a class="icon item">
                        <i class="left chevron icon"></i>
                    </a>
                    <a class="item">1</a>
                    <a class="item">2</a>
                    <a class="item">3</a>
                    <a class="item">4</a>
                    <a class="icon item">
                        <i class="right chevron icon"></i>
                    </a>
                </div>
            </div>
        </div>
   </div>
</div>
<script type="text/javascript" src="/static/map/world.js"></script>
<script type="text/javascript" src="/static/map/init_map.js"></script>
<script type="text/javascript" src="/static/front/js/init_kp_echart.js"></script>
<script type="text/javascript" src="/static/front/js/init_kp_echart_2.js"></script>
<script>
$(document).ready(function() {
    // 为 '详情' 按钮绑定点击事件
    $('.open-cti-detail').click(function() {
        var ctiId = $(this).data('id');
        openCtiDetailWindow('/cti-market/detail?id=' + ctiId);
    });

    //tab激活
    var currentTab = getUrlQueryString("tab")
    if(currentTab){
        $(".nav-item[href='/knowledge-plane?tab="+currentTab+"']").addClass("nav-item-active")
    }else{
        //激活第一个tab
        $(".nav-item").first().addClass("nav-item-active")
    }
    //地图切换
    $('.head-toolbar-1 a').on('click', function() {
        // 移除所有 a 元素的 blue 类
        $('.head-toolbar-1 a').removeClass('blue');
        $('.head-toolbar-1 a').removeClass('red')
        var tabName = $(this).data("tab")
        console.log(tabName)
        if(tabName=="china")
            $(this).removeClass('grey').addClass('red');
        else
            $(this).removeClass('grey').addClass('blue');
    });
    //类型切换
    $('.head-toolbar-2 a').on('click', function() {
        // 移除所有 a 元素的 blue 类
        $('.head-toolbar-2 a').removeClass('blue');
        var tabName = $(this).data("tab")
        console.log(tabName)
        $(this).removeClass('grey').addClass('blue');
    });
    //时序图切换
    $('.head-toolbar-3 a').on('click', function() {
        // 移除所有 a 元素的 blue 类
        $('.head-toolbar-3 a').removeClass('blue');
        var tabName = $(this).data("tab")
        console.log(tabName)
        $(this).removeClass('grey').addClass('blue');
        changeTimelineMode(tabName)
    });
});
var currentLayerIndex = null; //设置只可打开一个窗口
function openCtiDetailWindow(url) {
    if (currentLayerIndex !== null) {
        layer.close(currentLayerIndex);
    }
    currentLayerIndex = layer.open({
            type: 2,
            title: '详情',
            area: ['700px', '550px'], // 设置窗口宽度和高度
            shade: 0, // 设置遮罩透明度
            content: url,
            success: function(layero, index){
            }
    });
}
</script>
{{end}}
	
 
